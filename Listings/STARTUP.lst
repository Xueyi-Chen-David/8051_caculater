A51 MACRO ASSEMBLER  STARTUP                                                              01/11/2023 16:47:10 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN .\Objects\STARTUP.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE STARTUP.A51 SET(SMALL) DEBUG PRINT(.\Listings\STARTUP.lst) OBJECT(.\Obj
                      ects\STARTUP.obj) EP

LOC  OBJ            LINE     SOURCE

----                   1                     CSEG AT 0x0000  
0000 7A02              2                     MOV R2, #2; this is to limit the number to n digits!!!!!!!! (n)------------
                             ----
0002 7E00              3                     MOV R6, #0; for remember add(1) or sub(2) or equal(3)
                       4                     
0004                   5     BEGIN:  ;r2,3
0004 7400              6                     MOV A, #0 ;row
0006 7B00              7                     MOV R3, #0 ; i
                       8                     
0008                   9     SCAN:   
0008 EB               10                     MOV A, R3
0009 900078           11                     MOV DPTR, #ScanCode
000C 93               12                     MOVC A, @A+DPTR
000D F580             13                     MOV P0, A
000F E580             14                     MOV A,P0 ;when press A has a different resalt
0011 54F0             15                     ANL A,#0xf0
                      16                     
0013 B4E004           17                     CJNE A, #0xe0, T
0016 7800             18                     MOV R0, #0
0018 8019             19                     SJMP COUNT
                      20                     
001A B4D004           21     T:      CJNE A, #0xd0, T2
001D 7801             22                     MOV R0, #1
001F 8012             23                     SJMP COUNT
                      24                     
0021 B4B004           25     T2:     CJNE A, #0xb0, T3
0024 7802             26                     MOV R0, #2
0026 800B             27                     SJMP COUNT
                      28                     
0028 B47004           29     T3:     CJNE A, #0x70, T4
002B 7803             30                     MOV R0, #3
002D 8004             31                     SJMP COUNT
                      32                     
002F                  33     T4:     
002F 1153             34                     ACALL Display
0031 800E             35                     SJMP Default
                      36     
                      37     
0033                  38     COUNT:          
0033 E8               39                     MOV A, R0 ; put key=1,2,3,4 to A
0034 23               40                     RL A      ; key*2
0035 23               41                     RL A      ; key*4
0036 2B               42                     ADD A, R3 ; key*4 + i ;A can select which number 
0037 F5F0             43                     MOV B, A ; B = A        
0039 BA020B           44                     CJNE R2, #2, Handle1 ; no number no disaply
003C B40008           45                     CJNE A, #0, Handle1  ; first number is zero no disaply
003F 8000             46                     SJMP Default            
                      47     
0041                  48     Default: 
0041 0B               49                     INC R3
0042 BB04C3           50                     CJNE R3,#4,SCAN
0045 80BD             51                     SJMP BEGIN
                      52                     
0047                  53     Handle1:
0047 7CA0             54                     MOV R4, #0XA0
0049 114D             55                     ACALL ProcessNum
004B 80F4             56                     SJMP Default
A51 MACRO ASSEMBLER  STARTUP                                                              01/11/2023 16:47:10 PAGE     2

                      57     
                      58     
                      59     
004D                  60     ProcessNum: ; at most push 2 number
004D BA0003           61                     CJNE R2, #0, Pr1 ; if r2 is zero, it means don't put more digits in
0050 1153             62                     ACALL Display
0052 22               63                     RET
                      64                     
0053                  65     Pr1:
0053                  66     Display:
0053 60EC             67                     JZ Default ; if A is zero, it means no number is given
                      68                     
0055 C3               69                     CLR C
0056 7407             70                     MOV A, #7
0058 F8               71                     MOV R0, A ;move # to the left
                      72                     
0059 115C             73                     ACALL ShowNum
005B 22               74     E3:             RET
                      75                     
                      76                     
                      77     
                      78     
                      79     
                      80     
005C                  81     ShowNum:
005C 90006E           82             MOV DPTR,#TABLE
005F 8890             83                     MOV P1,R0 ; which led will be light
0061 E5F0             84                     MOV A, B
0063 93               85                     MOVC A,@A+DPTR
                      86                     
0064                  87     L0:             
0064 F5A0             88                     MOV P2,A
0066 1169             89                     ACALL DELAY
0068 22               90                     RET
                      91                     
0069                  92     DELAY: 
0069 79FF             93                     MOV R1, #0xff
006B D9FE             94                     DJNZ R1, $
006D 22               95                     RET
                      96                     
006E                  97     TABLE:  
006E 3F               98                     DB 3fh ;0
006F 06               99                 DB 06h ;1
0070 5B              100                 DB 5bh ;2
0071 4F              101                 DB 4fh ;3
0072 66              102                 DB 66h ;4
0073 6D              103                 DB 6dh ;5
0074 7D              104             DB 7dh ;6
0075 07              105                 DB 07h ;7
0076 7F              106                     DB 7fh ;8
0077 6F              107                     DB 6fh ;9
                     108                             
0078                 109     ScanCode:
0078 FE              110                     DB 11111110B ;0xfe
0079 FD              111                     DB 11111101B ;0xfd
007A FB              112                     DB 11111011B ;0xfb
007B F7              113                     DB 11110111B ;0xf7
                     114     
                     115     
                     116                     END             
                                                     
A51 MACRO ASSEMBLER  STARTUP                                                              01/11/2023 16:47:10 PAGE     3

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

B. . . . . . . . .  D ADDR   00F0H   A   
BEGIN. . . . . . .  C ADDR   0004H   A   
COUNT. . . . . . .  C ADDR   0033H   A   
DEFAULT. . . . . .  C ADDR   0041H   A   
DELAY. . . . . . .  C ADDR   0069H   A   
DISPLAY. . . . . .  C ADDR   0053H   A   
E3 . . . . . . . .  C ADDR   005BH   A   
HANDLE1. . . . . .  C ADDR   0047H   A   
L0 . . . . . . . .  C ADDR   0064H   A   
P0 . . . . . . . .  D ADDR   0080H   A   
P1 . . . . . . . .  D ADDR   0090H   A   
P2 . . . . . . . .  D ADDR   00A0H   A   
PR1. . . . . . . .  C ADDR   0053H   A   
PROCESSNUM . . . .  C ADDR   004DH   A   
SCAN . . . . . . .  C ADDR   0008H   A   
SCANCODE . . . . .  C ADDR   0078H   A   
SHOWNUM. . . . . .  C ADDR   005CH   A   
T. . . . . . . . .  C ADDR   001AH   A   
T2 . . . . . . . .  C ADDR   0021H   A   
T3 . . . . . . . .  C ADDR   0028H   A   
T4 . . . . . . . .  C ADDR   002FH   A   
TABLE. . . . . . .  C ADDR   006EH   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
